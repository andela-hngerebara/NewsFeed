<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for app/components/sources.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../index.html">All files</a> / <a href="index.html">app/components</a> sources.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">36.11% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>13/36</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">12.5% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>1/8</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">44.44% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>4/9</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">36.11% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>13/36</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">import React from 'react';
import * as NewsAPI from '../utils/NewsAPI';
import SourceStore from '../stores/SourceStore';
import SourceItem from './source-items';
import NewsStore from '../stores/NewsStore';
import NewsActions from '../actions/NewsActions';
import Articles from '../components/articles';
&nbsp;
export default class Sources extends React.Component {
    //create constructor having initial state set to display the sources available in the sourceStore
    //and sortBysAvailable declared as an array 
    //The additional functions(to load, change and filter) are also binded here
    //The deaultid is set to cnn
    constructor(props) {
        super(props);
        this.state = {
            sources: SourceStore.getAll(),
            sortBysAvailable: []
        };
        this._onLoad = this._onLoad.bind(this);
        this._onChange = this._onChange.bind(this);
        this.OnFilterChange = this.OnFilterChange.bind(this);
        this.defaultId = 'cnn';
    }
    
    
&nbsp;
//On mounting the page, the functtion for getiing sources from the api is called
    componentWillMount() {
        NewsAPI.getNewsSources();
    }
&nbsp;
//When the page actally mounts, the sourcestore listens for a change and calls the onload function which loads the sources to the page
//Also the the newsAPI for getting articles is called and it displays the default news as cnn which was given in the initial state
    componentDidMount() {
        SourceStore.addChangeListener(this._onLoad);
        NewsAPI.getNewsArticle(this.defaultId, this.sortBy);
        
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    co</span>mponentWillUnmount() {
<span class="cstat-no" title="statement not covered" >        SourceStore.removeChangeListener(this._onLoad);</span>
    }
    
    //sets the state to the sources in the stores
<span class="fstat-no" title="function not covered" >    _o</span>nLoad() {
<span class="cstat-no" title="statement not covered" >        this.setState({ sources: SourceStore.getAll() });</span>
    }
&nbsp;
    //Line 1- created a second reference to this
         //Line 2- Beacuse the sources is within an array of array, it can be accessed via this.state.sources[0]. 
        //...... to eliminate the lengthy naming, I store the value in sources variable
         //Line 3 t end of Function- Created a loop to loop through the source array and check if the value entered by the user matched the source id.
        //...if it matches, then I set the new state of source id to be the user Selection and pass it as a parameter tothe NewsApi that gets article so it
        //...displays the articles based on the user Selection 
<span class="fstat-no" title="function not covered" >    _o</span>nChange(event) {
        const that =<span class="cstat-no" title="statement not covered" >this;</span>
        let sources = <span class="cstat-no" title="statement not covered" >this.state.sources[0];</span>
        let prop = <span class="cstat-no" title="statement not covered" >0;</span>
<span class="cstat-no" title="statement not covered" >        for (; prop &lt; sources.length; prop++) {</span>
<span class="cstat-no" title="statement not covered" >            if (sources[prop].id === event.target.value) {</span>
<span class="cstat-no" title="statement not covered" >                that.setState({sourceId: sources[prop].id})</span>
                //console.log(that.state.sourceId)
<span class="cstat-no" title="statement not covered" >                this.setState({ sortBysAvailable: sources[prop].sortBysAvailable })</span>
<span class="cstat-no" title="statement not covered" >                this.sortBysAvailable = sources[prop].sortBysAvailable;</span>
<span class="cstat-no" title="statement not covered" >                NewsAPI.getNewsArticle(that.state.sourceId, this.sortBysAvailable)</span>
            }
        }
    }
&nbsp;
    //This function Filters the user sources based on the user input
     //It waits for the event (onKeyUp event) then calls this function
    //---------------------------------------------------------------
    //Line 1- It first gets all the sources then converts the user input into a string and also a lowercase
    //Line 2- then stores it into the filterBy vairable.
    //Line 3- Created a filteredlist array to store all the sources to be displayed based on user input
    //Line 4 to end of function- Then I checked the user enters and input or not to be searched. 
    //if no input entered, then all sources are displayed 
    //else I created a loop to go through the sources 
    //Then checks using Regular Expressions if the user input (filterBy) is same as the value(name of the Source)
    //If it tallys as the user is typing, it pushes the source into the filteredList array
    //then sets the new state to the filtered ist to be displayed to the user
    
<span class="fstat-no" title="function not covered" >    On</span>FilterChange(event) {
        const allSources = <span class="cstat-no" title="statement not covered" >this.state.sources[0];</span>
        const filterBy = <span class="cstat-no" title="statement not covered" >event.target.value.toString().toLowerCase();</span>
        const filteredList = <span class="cstat-no" title="statement not covered" >[];</span>
<span class="cstat-no" title="statement not covered" >        if (!event.target.value) {</span>
<span class="cstat-no" title="statement not covered" >            this.setState({</span>
                sources: allSources
            });
        } else {
<span class="cstat-no" title="statement not covered" >            for (var index = 0; index &lt; allSources.length; index++) {</span>
                let value = <span class="cstat-no" title="statement not covered" >allSources[index].name;</span>
<span class="cstat-no" title="statement not covered" >                if ((new RegExp(filterBy)).test(value.toLowerCase())) {</span>
<span class="cstat-no" title="statement not covered" >                    filteredList.push(allSources[index]);</span>
<span class="cstat-no" title="statement not covered" >                    this.setState({</span>
                        sources: [filteredList]
                    })
                }
            }
        }
&nbsp;
    }
&nbsp;
    //Line 1-Assigned sources to be storedin allSources
    //Line 2- The rows to display all sources delared as an array
    //Line 3- Assigned the OnChange() to be stored in change variable
    //Line 4- If all sources, it should map the source with its index as key and pass it to the child &lt;sourceitem&gt; as prop
    render() {
        let allSources = this.state.sources[0];
        let rows = [];
        //let change = this._onChange;
        <span class="missing-if-branch" title="if path not taken" >I</span>if (allSources) {
<span class="cstat-no" title="statement not covered" >            allSources.map(<span class="fstat-no" title="function not covered" >(i</span>tem, index) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >                rows.push(&lt;SourceItem key={index} value={item.id} name={item.name}</span>
                    onclick={this._onChange} /&gt;)
            });
        }
&nbsp;
        //using bootstrap styling, the entire page has 12 colns
        //assigning 2 colns to the sources and 10 to the articles
        //placed an input button at thetop for filter search
        //finally calls the arclescomponent to be displayed in the the 10 column 
        //passing sourceId and Sort by available whihis used for sorting
        return (
            &lt;div className="col-lg-12"&gt;
                &lt;div id="sidebar-wrapper" className="col-lg-2 list-group"&gt;
                    &lt;h4&gt;Please select News Source &lt;/h4&gt;
                    &lt;input type="text" className="form-control" placeholder="Search News...."
                         onKeyUp={this.OnFilterChange.bind(this)} /&gt;
                    &lt;div
                        onChange={this._onChange}
                        onLoad={this._onLoad}&gt;
                        {rows}
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div className="col-lg-10"&gt;
                    &lt;Articles source={this.state.sourceId} sortParams={this.state.sortBysAvailable} /&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        );
    }
}
&nbsp;
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="https://istanbul.js.org/" target="_blank">istanbul</a> at Wed May 03 2017 17:11:04 GMT+0100 (WAT)
</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
